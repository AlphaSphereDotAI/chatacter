name: Chatecter

on:
    push:
        branches: main

jobs:
    Dart:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
              with:
                  path: frontend
            - name: Flutter action
              uses: subosito/flutter-action@v2.13.0
              with:
                  channel: "stable"
                  cache: true
            - uses: dart-lang/setup-dart@v1
            - run: flutter pub get
            - run: dart format --set-exit-if-changed .
            - run: flutter analyze
    Django:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - name: Cache
              uses: actions/cache@v4
              with:
                  path: ~/.cache/pip
                  key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements.txt') }}
                  restore-keys: ${{ runner.os }}-pip-
            - name: Set up Python
              uses: actions/setup-python@v5
              with:
                  cache: "pip"
            - name: Install Dependencies
              run: python -m pip install --upgrade pip && pip install Django
            - name: Run Tests
              run: cd backend && python manage.py test
